{"remainingRequest":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\src\\views\\admin\\UpdatePassword.vue?vue&type=style&index=0&id=62569a7e&scoped=true&lang=scss&","dependencies":[{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\src\\views\\admin\\UpdatePassword.vue","mtime":1748879833000},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1770531371325},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1770531338946},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\postcss-loader\\src\\index.js","mtime":1770531352754},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1770531346550},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1770531376377},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\vue-loader\\lib\\index.js","mtime":1770531338936}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnBhc3N3b3JkLWNvbnRhaW5lciB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGhlaWdodDogNDMwcHg7DQogICAgcGFkZGluZy1ibG9jazogMjBweDsNCn0NCg0KLnBhc3N3b3JkLWNhcmQgew0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQogICAgYm9yZGVyLXJhZGl1czogMTJweDsNCiAgICAvL2JveC1zaGFkb3c6IDAgOHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjA1KTsNCn0NCg0KLnBhc3N3b3JkLXRpdGxlIHsNCiAgICBtYXJnaW4tYm90dG9tOiAzMHB4Ow0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBjb2xvcjogIzMwMzEzMzsNCiAgICBmb250LXdlaWdodDogNTAwOw0KICAgIGZvbnQtc2l6ZTogMjRweDsNCn0NCg0KOjp2LWRlZXAgLmVsLWZvcm0taXRlbV9fbGFiZWwgew0KICAgIGZvbnQtd2VpZ2h0OiA1MDA7DQogICAgY29sb3I6ICM2MDYyNjY7DQogICAgcGFkZGluZy1ib3R0b206IDhweDsNCn0NCg0KOjp2LWRlZXAgLmVsLWlucHV0X19pbm5lciB7DQogICAgaGVpZ2h0OiA0NHB4Ow0KICAgIGxpbmUtaGVpZ2h0OiA0NHB4Ow0KICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCn0NCg0KLnBhc3N3b3JkLWhpbnQgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBjb2xvcjogIzkwOTM5OTsNCiAgICBtYXJnaW4tdG9wOiA2cHg7DQp9DQoNCi5zdWJtaXQtYnRuIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBoZWlnaHQ6IDQ0cHg7DQogICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgIGZvbnQtc2l6ZTogMTZweDsNCiAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KfQ0KDQpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsNCiAgICAucGFzc3dvcmQtY2FyZCB7DQogICAgICAgIHBhZGRpbmc6IDMwcHggMjBweDsNCiAgICB9DQp9DQo="},{"version":3,"sources":["UpdatePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"UpdatePassword.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\r\n    <div class=\"password-container\">\r\n        <div class=\"password-card\">\r\n            <el-form ref=\"passwordForm\" :model=\"form\" :rules=\"rules\" label-position=\"top\"\r\n                @submit.native.prevent=\"submitForm\">\r\n                <el-form-item label=\"当前密码\" prop=\"oldPassword\">\r\n                    <el-input v-model=\"form.oldPassword\" type=\"password\" placeholder=\"请输入当前密码\" show-password\r\n                        clearable></el-input>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n                    <el-input v-model=\"form.newPassword\" type=\"password\" placeholder=\"请输入新密码\" show-password\r\n                        clearable></el-input>\r\n                    <div class=\"password-hint\">密码长度8-20位，需包含字母和数字</div>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"确认新密码\" prop=\"againPassword\">\r\n                    <el-input v-model=\"form.againPassword\" type=\"password\" placeholder=\"请再次输入新密码\" show-password\r\n                        clearable></el-input>\r\n                </el-form-item>\r\n\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" native-type=\"submit\" :loading=\"loading\" class=\"submit-btn\">\r\n                        确认修改\r\n                    </el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { clearToken, clearRole, clearUserInfoo } from \"@/utils/storage\"\r\nimport { clearUserInfo } from \"../../utils/storage\";\r\nexport default {\r\n    name: \"UpdatePassword\",\r\n    data() {\r\n        const validatePassword = (rule, value, callback) => {\r\n            if (value === '') {\r\n                callback(new Error('请输入密码'));\r\n            } else if (value.length < 8 || value.length > 20) {\r\n                callback(new Error('密码长度需在8-20位之间'));\r\n            } else if (!/[a-zA-Z]/.test(value) || !/\\d/.test(value)) {\r\n                callback(new Error('密码需包含字母和数字'));\r\n            } else {\r\n                if (this.form.againPassword !== '') {\r\n                    this.$refs.passwordForm.validateField('againPassword');\r\n                }\r\n                callback();\r\n            }\r\n        };\r\n\r\n        const validateAgainPassword = (rule, value, callback) => {\r\n            if (value === '') {\r\n                callback(new Error('请再次输入密码'));\r\n            } else if (value !== this.form.newPassword) {\r\n                callback(new Error('两次输入密码不一致'));\r\n            } else {\r\n                callback();\r\n            }\r\n        };\r\n\r\n        return {\r\n            loading: false,\r\n            form: {\r\n                oldPassword: '',\r\n                newPassword: '',\r\n                againPassword: ''\r\n            },\r\n            rules: {\r\n                oldPassword: [\r\n                    { required: true, message: '请输入当前密码', trigger: 'blur' }\r\n                ],\r\n                newPassword: [\r\n                    { required: true, validator: validatePassword, trigger: 'blur' }\r\n                ],\r\n                againPassword: [\r\n                    { required: true, validator: validateAgainPassword, trigger: 'blur' }\r\n                ]\r\n            }\r\n        };\r\n    },\r\n    methods: {\r\n        submitForm() {\r\n            this.$refs.passwordForm.validate(valid => {\r\n                if (valid) {\r\n                    this.loading = true;\r\n                    const updatePasswordDto = {\r\n                        oldPassword: this.$md5(this.$md5(this.form.oldPassword)),\r\n                        newPassword: this.$md5(this.$md5(this.form.newPassword)),\r\n                        againPassword: this.$md5(this.$md5(this.form.againPassword)),\r\n                    }\r\n                    this.$axios.put('/user/updatePassword', updatePasswordDto)\r\n                        .then(response => {\r\n                            if (response.code === 200) {\r\n                                this.$message.success('密码修改成功，请重新登录');\r\n                                // 清空表单\r\n                                this.$refs.passwordForm.resetFields();\r\n                                clearToken();//清空Token\r\n                                clearRole(); // 清空角色\r\n                                clearUserInfo(); // 清空用户信息\r\n                                this.$router.push('/login'); // 返回登录页\r\n                            } else {\r\n                                this.$message.error(response.message || '密码修改失败');\r\n                            }\r\n                        })\r\n                        .catch(error => {\r\n                            this.$message.error(error.message);\r\n                        })\r\n                        .finally(() => {\r\n                            this.loading = false;\r\n                        });\r\n                } else {\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.password-container {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 430px;\r\n    padding-block: 20px;\r\n}\r\n\r\n.password-card {\r\n    width: 100%;\r\n    background-color: #fff;\r\n    border-radius: 12px;\r\n    //box-shadow: 0 8px 12px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.password-title {\r\n    margin-bottom: 30px;\r\n    text-align: center;\r\n    color: #303133;\r\n    font-weight: 500;\r\n    font-size: 24px;\r\n}\r\n\r\n::v-deep .el-form-item__label {\r\n    font-weight: 500;\r\n    color: #606266;\r\n    padding-bottom: 8px;\r\n}\r\n\r\n::v-deep .el-input__inner {\r\n    height: 44px;\r\n    line-height: 44px;\r\n    border-radius: 8px;\r\n}\r\n\r\n.password-hint {\r\n    font-size: 12px;\r\n    color: #909399;\r\n    margin-top: 6px;\r\n}\r\n\r\n.submit-btn {\r\n    width: 100%;\r\n    height: 44px;\r\n    border-radius: 8px;\r\n    font-size: 16px;\r\n    margin-top: 10px;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .password-card {\r\n        padding: 30px 20px;\r\n    }\r\n}\r\n</style>"]}]}