{"remainingRequest":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\src\\views\\user\\NewsDetail.vue?vue&type=style&index=0&id=16b846be&scoped=true&lang=scss&","dependencies":[{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\src\\views\\user\\NewsDetail.vue","mtime":1756045099000},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\css-loader\\dist\\cjs.js","mtime":1770531371325},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1770531338946},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\postcss-loader\\src\\index.js","mtime":1770531352754},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1770531346550},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1770531376377},{"path":"C:\\Users\\86184\\Desktop\\校园新闻系统\\source code\\view\\node_modules\\vue-loader\\lib\\index.js","mtime":1770531338936}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoubmV3cy1jb250YWluZXIgewogICAgbWFyZ2luOiAwIGF1dG87CiAgICB3aWR0aDogMTAwMHB4OwogICAgcGFkZGluZzogMzBweCA2MHB4OwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGxlZnQ7CiAgICBnYXA6IDMwcHg7CgogICAgLm9wZXJhdGlvbiB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIHBhZGRpbmc6IDIwcHggMTBweDsKICAgICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiKDI0MCwgMjQwLCAyNDApOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgICAgICAgdG9wOiAzMDBweDsKICAgICAgICBsZWZ0OiA4MHB4OwoKICAgICAgICBkaXYgewogICAgICAgICAgICBwYWRkaW5nOiA2cHggMTBweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgZ2FwOiA2cHg7CgogICAgICAgICAgICBpbWcgewogICAgICAgICAgICAgICAgd2lkdGg6IDIwcHg7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDIwcHg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkgewogICAgICAgICAgICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICAgICAgICB9CgogICAgICAgICAgICAmOmhvdmVyIHsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDYsIDI0NiwgMjQ2KTsKICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAubGVmdCB7CiAgICAgICAgd2lkdGg6IDcwJTsKCiAgICAgICAgLmRldGFpbCB7CiAgICAgICAgICAgIHBhZGRpbmctYmxvY2s6IDIwcHg7CgogICAgICAgICAgICAucG9pbnQgewogICAgICAgICAgICAgICAgbWFyZ2luLWJsb2NrOiAyMHB4OwogICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKCiAgICAgICAgICAgICAgICAuZmxvdy1pbmRleCB7CiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgICAgICAgICBnYXA6IDEycHg7CiAgICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICAgICAgICAgICAgICBjb2xvcjogcmdiKDEwNiwgODYsIDg2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLnRpdGxlIHsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMzBweDsKICAgICAgICAgICAgICAgIHBhZGRpbmctYmxvY2s6IDEwcHg7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgICAgICAgICAgcG9zaXRpb246IHN0aWNreTsKICAgICAgICAgICAgICAgIHRvcDogMDsKICAgICAgICAgICAgICAgIHotaW5kZXg6IDEwMDsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLnN1bW1hcnkgewogICAgICAgICAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjQ4LCAyNDgsIDI0OCk7CiAgICAgICAgICAgICAgICBtYXJnaW4tYmxvY2s6IDEwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLnJpZ2h0IHsKICAgICAgICB3aWR0aDogMzAlOwogICAgICAgIC8vIGJveC1zaGFkb3c6IDAgNnB4IDEycHggcmdiKDI0MCwgMjQwLCAyNDApOwogICAgICAgIHBhZGRpbmc6IDEwcHggMzBweDsKICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsKCiAgICAgICAgLm5vLW5ld3MgewogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICAgICAgaGVpZ2h0OiAyMDBweDsKICAgICAgICAgICAgY29sb3I6ICM5OTk7CgogICAgICAgICAgICBpIHsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogNDBweDsKICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC5uZXdzLXRpdGxlIHsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKICAgICAgICAgICAgbWFyZ2luLXRvcDogOHB4OwoKICAgICAgICAgICAgJjpob3ZlciB7CiAgICAgICAgICAgICAgICBjb2xvcjogIzQwOUVGRjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCn0K"},{"version":3,"sources":["NewsDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"NewsDetail.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n    <div class=\"news-container\">\n        <div class=\"left\">\n            <div>\n                <el-page-header @back=\"goBack\" content=\"详情页面\">\n                </el-page-header>\n            </div>\n            <div class=\"detail\">\n                <div class=\"title\">{{ news.title }}</div>\n                <div class=\"point\">\n                    <div class=\"flow-index\">\n                        <span>\n                            发布于{{ news.createTime }}\n                        </span>\n                        <span>\n                            {{ news.viewCount }}人阅读\n                        </span>\n                        <span>\n                            {{ news.collectionCount }}人收藏\n                        </span>\n                        <span>\n                            {{ news.upvoteCount }}人点赞\n                        </span>\n                    </div>\n                    <div><el-tag size=\"mini\" type=\"success\">{{ news.newsTypeName }}</el-tag></div>\n                </div>\n                <div class=\"summary\">{{ news.summary }}</div>\n                <div class=\"content\" v-html=\"news.content\"></div>\n            </div>\n            <div>\n                <Evaluations contentType=\"NEWS\" :contentId=\"Number(id)\" :userId=\"Number(userId)\"\n                    :avatar=\"String(avatar)\" />\n            </div>\n        </div>\n        <!-- 行为操作区 -->\n        <div class=\"operation\">\n            <div v-if=\"!collectionOperationList.length\">\n                <div @click=\"collectionOperation\">\n                    <i class=\"el-icon-star-off\"></i>\n                    收藏\n                </div>\n\n            </div>\n            <div v-else>\n                <div @click=\"collectionOperation\">\n                    <i class=\"el-icon-star-on\"></i>\n                    取消收藏\n                </div>\n\n            </div>\n            <div v-if=\"!upvoteList.length\">\n                <div @click=\"upvoteOperation\">\n                    <img src=\"/update-active.png\" alt=\"\">\n                    点赞\n                </div>\n\n            </div>\n            <div v-else>\n                <div @click=\"upvoteOperation\">\n                    <img src=\"/update-default.png\" alt=\"\">\n                    取消点赞\n                </div>\n\n            </div>\n        </div>\n        <div class=\"right\">\n            <div style=\"font-size: 24px;margin-bottom: 10px;font-weight: 600;\">新闻推荐</div>\n            <template v-if=\"recommendNews.length\">\n                <div style=\"margin-bottom: 10px;\" v-for=\"item in recommendNews\" :key=\"item.id\">\n                    <img style=\"width: 100%;height: 140px;border-radius: 5px;object-fit: cover;\" :src=\"item.cover || ''\"\n                        alt=\"新闻封面\">\n                    <div @click=\"read(item.id)\" class=\"news-title\">\n                        {{ item.title }}\n                    </div>\n                </div>\n            </template>\n            <div v-else class=\"no-news\">\n                <i class=\"el-icon-news\"></i>\n                <span>暂无最新新闻</span>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport Evaluations from '@/components/Evaluations.vue';\nexport default {\n    components: { Evaluations },\n    data() {\n        return {\n            id: null,\n            news: {},\n            userId: 0,\n            avatar: '',\n            collectionOperationList: [],\n            upvoteList: [],\n            startTime: null, // 开始阅读时间\n            recommendNews: [],\n        }\n    },\n    async created() {\n        await this.fetchUserInfo();\n        this.id = this.$router.currentRoute.query.id;\n        this.read(this.id);\n        // this.fetchDetail(this.id); // 通过ID查询新闻详情\n        // this.fetchCollectionInfo(this.id); // 查询用户收藏新闻情况\n        // this.fetchUpvoteInfo(this.id); // 查询用户点赞新闻情况\n        // this.saveViewOperation(this.id); // 记录用户的阅读行为\n        // this.initStartTime();\n        // window.addEventListener('beforeunload', this.endTimeClose);\n        this.fetchRecommendHealthNews(3); // 默认推荐3条\n    },\n    methods: {\n        read(id) {\n            this.id = id;\n            this.fetchDetail(id); // 通过ID查询新闻详情\n            this.fetchCollectionInfo(id); // 查询用户收藏新闻情况\n            this.fetchUpvoteInfo(id); // 查询用户点赞新闻情况\n            this.saveViewOperation(id); // 记录用户的阅读行为\n            this.initStartTime();\n            window.addEventListener('beforeunload', this.endTimeClose);\n        },\n        async fetchRecommendHealthNews(count) {\n            try {\n                const { data } = await this.$axios.get(`/news/recommend/${count}`);\n                this.recommendNews = data;\n            } catch (error) {\n                this.$message.info(error.message);\n            }\n        },\n        // 记录用户的停留行为\n        async endTimeClose() {\n            try {\n                const endTime = new Date().getTime();\n                const taskTime = endTime - this.startTime;\n                const dto = {\n                    type: 4, //声明是停留行为\n                    newsId: this.id,\n                    times: taskTime,\n                }\n                await this.$axios.post(`/action-operation/saveEntity`, dto);\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('记录停留时长情况异常:', error);\n            }\n        },\n        initStartTime() {\n            this.startTime = new Date().getTime(); // 返回当前时间的时间戳\n        },\n        // 记录阅读行为\n        async saveViewOperation(id) {\n            try {\n                const dto = {\n                    type: 2, //声明是阅读行为\n                    newsId: id\n                }\n                await this.$axios.post(`/action-operation/saveEntity`, dto);\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('记录行为操作情况异常:', error);\n            }\n        },\n        goBack() {\n            this.$router.push('/user');\n        },\n        async collectionOperation() {\n            try {\n                const dto = {\n                    type: 3, //声明是收藏行为\n                    newsId: this.id\n                }\n                await this.$axios.post(`/action-operation/operation`, dto);\n                this.fetchCollectionInfo(this.id);\n                this.fetchDetail(this.id); // 通过ID查询新闻详情\n                this.$notify({\n                    title: '收藏操作',\n                    message: this.collectionOperationList.length ? '取消收藏成功' : '收藏成功',\n                    type: 'success',\n                    duration: 1000,\n                    position: 'bottom-right'\n                });\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('收藏行为操作异常:', error);\n            }\n        },\n        async fetchUpvoteInfo(id) {\n            try {\n                const dto = {\n                    type: 1, //声明是点赞行为\n                    newsId: id\n                }\n                const { data } = await this.$axios.post(`/action-operation/list`, dto);\n                this.upvoteList = data;\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('查询点赞行为操作情况异常:', error);\n            }\n        },\n        async upvoteOperation() {\n            try {\n                const dto = {\n                    type: 1, //声明是收藏行为\n                    newsId: this.id\n                }\n                await this.$axios.post(`/action-operation/operation`, dto);\n                this.fetchUpvoteInfo(this.id);\n                this.fetchDetail(this.id); // 通过ID查询新闻详情\n                this.$notify({\n                    title: '点赞操作',\n                    message: this.collectionOperationList.length ? '已取消点赞' : '点赞成功',\n                    type: 'success',\n                    duration: 1000,\n                    position: 'bottom-right'\n                });\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('点赞行为操作异常:', error);\n            }\n        },\n        async fetchCollectionInfo(id) {\n            try {\n                const dto = {\n                    type: 3, //声明是收藏行为\n                    newsId: id\n                }\n                const { data } = await this.$axios.post(`/action-operation/list`, dto);\n                this.collectionOperationList = data;\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('查询收藏行为操作情况异常:', error);\n            }\n        },\n        async fetchUserInfo() {\n            try {\n                const { data } = await this.$axios.get(`/user/auth`);\n                this.userId = data.id; // 用户ID\n                this.avatar = data.avatar; // 用户头像\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('查询用户信息异常:', error);\n            }\n        },\n        async fetchDetail(id) {\n            try {\n                const { data } = await this.$axios.get(`/news/${id}`);\n                this.news = { ...data };\n            } catch (error) {\n                this.$message.warning(error.message);\n                console.error('查询新闻详情异常:', error);\n            }\n        },\n    }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.news-container {\n    margin: 0 auto;\n    width: 1000px;\n    padding: 30px 60px;\n    box-sizing: border-box;\n    display: flex;\n    justify-content: left;\n    gap: 30px;\n\n    .operation {\n        position: fixed;\n        padding: 20px 10px;\n        box-shadow: 0 4px 6px rgb(240, 240, 240);\n        border-radius: 20px;\n        top: 300px;\n        left: 80px;\n\n        div {\n            padding: 6px 10px;\n            cursor: pointer;\n            font-weight: 500;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            gap: 6px;\n\n            img {\n                width: 20px;\n                height: 20px;\n            }\n\n            i {\n                font-size: 20px;\n            }\n\n            &:hover {\n                background-color: rgb(246, 246, 246);\n                border-radius: 4px;\n            }\n        }\n    }\n\n    .left {\n        width: 70%;\n\n        .detail {\n            padding-block: 20px;\n\n            .point {\n                margin-block: 20px;\n                display: flex;\n                justify-content: space-between;\n\n                .flow-index {\n                    display: flex;\n                    gap: 12px;\n                    font-weight: 500;\n                    color: rgb(106, 86, 86);\n                }\n            }\n\n            .title {\n                font-size: 30px;\n                padding-block: 10px;\n                font-weight: 600;\n                position: sticky;\n                top: 0;\n                z-index: 100;\n                background-color: rgb(255, 255, 255);\n            }\n\n            .summary {\n                padding: 10px;\n                box-sizing: border-box;\n                background-color: rgb(248, 248, 248);\n                margin-block: 10px;\n                font-size: 14px;\n            }\n        }\n    }\n\n    .right {\n        width: 30%;\n        // box-shadow: 0 6px 12px rgb(240, 240, 240);\n        padding: 10px 30px;\n        box-sizing: border-box;\n        border-radius: 5px;\n\n        .no-news {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            height: 200px;\n            color: #999;\n\n            i {\n                font-size: 40px;\n                margin-bottom: 10px;\n            }\n        }\n\n        .news-title {\n            cursor: pointer;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            margin-top: 8px;\n\n            &:hover {\n                color: #409EFF;\n            }\n        }\n    }\n\n}\n</style>"]}]}